var  ITEMS=[

  { id:1, 
    brand_name:"Louis Philip",
productType:"mansclothing",
    name:"LP Brand - Symbol Men Shirt",
   image_url:"https://m.media-amazon.com/images/I/A1wEjvjUA-L._AC_UL480_FMwebp_QL65_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/A1yExRGrofL._AC_UX679_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/91ELg13MgUL._AC_UX679_.jpg",
   strikedoffprice: "799",
   price: "557",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:2, 
  brand_name:"Louis Philip",
productType:"mansclothing",
    name:"LP Brand - Symbol Men Shirt",
   image_url:"https://m.media-amazon.com/images/I/911xrpb4BGL._AC_UL480_FMwebp_QL65_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/91feHr7BH1L._AC_UY879_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/91EiDMKUUuL._AC_UY879_.jpg",
   strikedoffprice: "799",
   price: "557",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},

{  id:3, 
  brand_name:"Louis Philip",
productType:"mansclothing",
    name:"LP Brand - Symbol Men Shirt",
   image_url:"https://m.media-amazon.com/images/I/71ORz8flzkL._AC_UL480_QL65_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/61pO6WKIePL._AC_UY879_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/71Md5hfnoLL._AC_UY879_.jpg",
   strikedoffprice: "799",
   price: "557",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},

{  id:4, 
  brand_name:"Louis Philip",
productType:"mansclothing",
    name:"LP Brand - Symbol Men Shirt",
   image_url:"https://m.media-amazon.com/images/I/61UqWXWlsbL._AC_UL480_FMwebp_QL65_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/81NP3Awt2VL._AC_UY879_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/71TsJcKT6BL._AC_UY879_.jpg",
   strikedoffprice: "799",
   price: "557",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:5, 
  brand_name:"MAN MATTERS",
  productType:"mansCream",
    name:"Man Matters Biotin Hair Gummies | 60 Days Pack | With Biotin, |100% Vegetarian | 60 Gummies",
   image_url:"https://m.media-amazon.com/images/I/81bt4NnbTOL._AC_UL400_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/81jL0EGMmfL._SX569_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/812po+vEY3L._SX569_.jpg",
   strikedoffprice: "849",
   price: "799",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:6, 
  brand_name:"The Man Company",
productType:"mansCream",
    name:"The Man Company Skin Brightening Cream with Multani Mitti, Coco Butter | Removes Blackhead - 30 gm",
   image_url:"https://m.media-amazon.com/images/I/51QZU5qQRVL._SY450_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/71YpI+Nin1L._SY450_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/71LBwLbxtxL._SY450_.jpg",
   strikedoffprice: "299",
   price: "189",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:7, 
  brand_name:"GARNIER",
productType:"mansCream",
    name:"Garnier Men, Face Wash, Brightening & Anti-Pollution, TurboBright Double Action, 150 g",
   image_url:"https://m.media-amazon.com/images/I/51YOFiC3zvL._AC_UL400_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/61pOAOfbDML._SX425_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/61qEEmhOTLL._SX425_.jpg",
   strikedoffprice: "325",
   price: "262",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:8, 
  brand_name:"URBAN FOREST",
productType:"wallet",
    name:"URBAN FOREST Oliver Redwood Leather Wallet for Men",
   image_url:"https://m.media-amazon.com/images/I/71t7CgBwJ4L._AC_UL400_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/81wc7fARCsL._SY741_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/81T8LdEzLQL._SX569_.jpg",
   strikedoffprice: "2000",
   price: "499",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:9, 
  brand_name:"RIGOHILL",
productType:"wallet",
    name:"RIGOHILL Doger Olive Green Mens Leather Wallet | Leather Wallet for Men | RFID Mens Wallet",
   image_url:"https://m.media-amazon.com/images/I/71SYvtX2YmL._AC_UL400_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/71lhhYRTFpL._SX569_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/81FlhNtY3NL._SX569_.jpg",
   strikedoffprice: "2499",
   price: "499",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:10, 
  brand_name:"NAPA HIDE",
productType:"wallet",
    name:"NAPA HIDE Leather Wallet for Men I Handcrafted I Multiple Credit | I 2 Secret Compartments",
   image_url:"https://m.media-amazon.com/images/I/81aZAmkJQWL._AC_UL400_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/91GgbctZ1EL._UX679_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/81gZOqQXT9L._UX679_.jpg",
   strikedoffprice: "1499",
   price: "299",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:11, 
  brand_name:"WildHorn",
productType:"wallet",
    name:"WildHorn Trifold Leather Wallet for Men I Handcrafted I Ultra Strong Stitching | I Currency Compartment",
   image_url:"https://m.media-amazon.com/images/I/71SJJMXG19L._AC_UL400_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/813-bVZMpIL._SX569_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/81LLM2H7xsL._SX569_.jpg",
   strikedoffprice: "1499",
   price: "299",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:12, 
  brand_name:"Fastrac",
productType:"mansSunglasses",
    name:"Fastrack Men Square Black Sunglasses-Pack of 1",
   image_url:"https://m.media-amazon.com/images/I/61+THk53YIL._AC_UL400_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/619hy5yVQWL._UX522_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/61vPBNLue7L._UX679_.jpg",
   strikedoffprice: "799",
   price: "699",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:13, 
  brand_name:"VELOCITY STORE",
productType:"mansSunglasses",
    name:"Velocity Polarized Aviator Green INJ POL Sunglasses for Men",
   image_url:"https://m.media-amazon.com/images/I/51TZG3rY+DL._UX679_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/51J7FIerYCL._UX679_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/518KAsYiirL._UX679_.jpg",
   strikedoffprice: "1499",
   price: "1299",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:14, 
  brand_name:"Fastrack",
productType:"mansSunglasses",
    name:"Fastrack Men Pilot Green Sunglasses-Pack of 1",
   image_url:"https://m.media-amazon.com/images/I/61XFwxOh4GL._UX679_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/61X3yRvhrLL._UX679_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/71RLeDOfVEL._UX522_.jpg",
   strikedoffprice: "2099",
   price: "1965",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:15, 
  brand_name:"ELEGANTE",
productType:"mansSunglasses",
    name:"ELEGANTE Mens Square Sunglasses, UV Protected Stylish Sun Glasses for Men",
   image_url:"https://m.media-amazon.com/images/I/51bzps707YL._UX679_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/71lCmJtpyHL._UX679_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/61vE4kusVTL._UX679_.jpg",
   strikedoffprice: "2499",
   price: "596",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:16, 
  brand_name:"FREECULTR",
productType:"mansclothing",
    name:"FREECULTR Unisex Printed Bamboo Bandana Face Mask for Dust and Sun Protection",
   image_url:"https://m.media-amazon.com/images/I/718-a6R5nWL._UX425_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/71CS9pbsQPL._UX425_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/71xrPzGy+0L._UX425_.jpg",
   strikedoffprice: "999",
   price: "499",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:17, 
  brand_name:"Lymio",
productType:"mansclothing",
    name:"Lymio Casual Shirt for Men|| Shirt for Men|| Men Stylish Shirt || Men Printed Shirt (Patta)",
   image_url:"https://m.media-amazon.com/images/I/71On2XSPuRL._UY445_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/81300Ou0hAL._UY445_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/7143xg-yZVL._UY445_.jpg",
   strikedoffprice: "4999",
   price: "379",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:18, 
  brand_name:"Amazon",
productType:"mansclothing",
    name:"Amazon Brand - Symbol Men Shirt",
   image_url:"https://m.media-amazon.com/images/I/81gEEU2IeHL._UX522_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/81jMs8fB4fL._UX522_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/91yl4ysaxoL._UX522_.jpg",
   strikedoffprice: "2099",
   price: "557",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
},
{  id:19, 
  brand_name:"Amazon",
productType:"mansclothing",
    name:"Amazon Brand - Symbol Men Formal Shirt",
   image_url:"https://m.media-amazon.com/images/I/713xbqIKW4L._UX522_.jpg",
   image_url1:"https://m.media-amazon.com/images/I/81tuLcV5zTL._UX522_.jpg",
   image_url2:"https://m.media-amazon.com/images/I/61PNLI3SYrL._UX522_.jpg",
   strikedoffprice: "1699",
   price: "836",
   save: "save 30%",
     extrasave : "Extra 15% OFF",
     qty:1
}
 ];
// let cartData=JSON.parse(localStorage.getItem("cartPage"))||[];

// function displayCart(data){
    
//         let parent=document.getElementById("cartPage");
//         parent.innerHTML="";
//         let bag=document.createElement("h2");
//         bag.textContent=`Your bag(${data.length} items)`
//         let notification=document.createElement("h3");
//         notification.textContent="Congrats! You get free standard shopping"
//         let line=document.createElement("hr");
//         parent.append(bag,notification,line);
       
       
//         data.map((el)=>{
//         let cart=document.createElement("div");
//         let left=document.createElement("div");
        
//         let right=document.createElement("div");
//         let image=document.createElement("img");
//         image.src=el.image_url;
        
//         let name=document.createElement("a");
//         name.textContent=el.name;
//         let price=document.createElement("p");
//         price.textContent=el.price;
//         let top=document.createElement("div");
        
//         let likebtn=document.createElement("button");
//         top.append(name,likebtn);
//         let buttom=document.createElement("div");
//         // let increase=document.createElement("button");
//         // let decrease=document.createElement("button");
//         let remove=document.createElement("button");
//         remove.textContent="Remove";
//         buttom.append(price);
//         let line=document.createElement("hr");
//         left.append(image);
//         right.append(top,buttom);
//         cart.append(remove,left,right);
//         parent.append(cart,line);
//     })
// }

// displayCart(cartData);

let cart_data=JSON.parse(localStorage.getItem("cartPage"))||[]

const openBtn=document.getElementById('open_cart_btn')
const cart=document.getElementById('side_cart')
const closeBtn=document.getElementById('close_btn')
const backdrop=document.querySelector('.backdrop')
const itemsEl=document.querySelector('.items')
const cartItems=document.querySelector('.cart_items')
const itemsNum=document.getElementById('items_num')
const itemsNums=document.getElementById('items_nums')
const subtotalPrice=document.getElementById('subtotal_price')
const checkout=document.getElementById('checkout')

renderItems()
renderCartItems()



openBtn.addEventListener('click',openCart)
closeBtn.addEventListener('click',closeCart)
backdrop.addEventListener('click',closeCart)


//Open Cart
function openCart(){
  cart.classList.add('open')
  backdrop.style.display='block'
  setTimeout(()=>{
    backdrop.classList.add('show');
  },0)
}

//Close Cart
function closeCart(){
  cart.classList.remove('open')
  backdrop.classList.remove('show');
  
  setTimeout(()=>{
    backdrop.style.display='none'
  },500)
}

//Add Items to Cart
function addItem(idx,itemId){
  //find same items
  const foundedItem=cart_data.find(item=>item.id.toString()===itemId.toString())
  if(foundedItem){
    //increase item qty
    increaseQty(itemId)
  }else{
    cart_data.push(ITEMS[idx])
  }
updateCart();
openCart();
}

//Render Items
function renderItems(){
  ITEMS.forEach((item,idx)=>{
    const itemEl=document.createElement('div')
    itemEl.classList.add('items')
    
    itemEl.innerHTML=`<img src="${item.image_url}" alt="">
    <button onclick="addItem(${idx},${item.id})">Add to Cart</button>`
    itemsEl.appendChild(itemEl)
  })
}

// Remove cart Items 
function removeCartItem(itemId){
  cart_data=cart_data.filter((item)=>item.id!=itemId)
  updateCart()
}

//Increase Qty
function increaseQty(itemId){
  cart_data=cart_data.map(item=>item.id.toString()===itemId.toString()?{...item,qty:item.qty+1}:item)
  updateCart()
}
//Decrease Qty
function decreaseQty(itemId){
  cart_data=cart_data.map(item=>item.id.toString()===itemId.toString()?{...item,qty:item.qty>1?item.qty-1:item.qty}:item)
  updateCart()
}

// Calculate Items Number
function calcItemsNum(){
  let itemsCount=0

  cart_data.forEach((item)=>(itemsCount+=item.qty))

  itemsNums.innerText=`(${itemsCount} items)`
}

// Calculate Subtotal Price
function calcSubtotalPrice(){
  let subtotal=0
  checkout.innerText=''

  cart_data.forEach((item)=>(subtotal+=item.price*item.qty))

  subtotalPrice.innerText=subtotal
  checkout.innerText=`$${subtotal} - Checkout`
}

//Display /Render Cart Items

function renderCartItems(){
  //remove everything from cart
  cartItems.innerHTML=''

    if(cart_data.length>0){
      let mid=document.createElement('div')
      let notify=document.createElement('h5')
      notify.innerText='Congrats! You get free standard shopping'
      let lin=document.createElement('hr')
      mid.append(notify,lin);
      cartItems.append(mid)
    }
    

  //add new data
  cart_data.forEach((item,i)=>{
    const cartItem=document.createElement('div')
    cartItem.classList.add('cart_item')
    cartItem.innerHTML=
    `   
    <div class="mul" onclick="removeCartItem(${item.id})" class="remove_item">
        <span id="delP">&times;</span>
    </div>
    <div class="cartS">
      <div class="item_img">
          <img src="${item.image_url}" alt="">
      </div>
      <div class="item_details">
          <p>${item.name}</p>
          <strong>$${item.price}</strong>
          <div class="qty">
              <span onclick="decreaseQty(${item.id})">-</span>
              <strong>${item.qty}</strong>
              <span onclick="increaseQty(${item.id})">+</span>
          </div>
      </div>
    </div>
    `
    cartItems.appendChild(cartItem)
    
  })
}

//update cart
function updateCart(){
  //rerender cart items with updated data
  renderCartItems();
  //Update Items Number in cart
  calcItemsNum();
  // Update Subtotal Price
  calcSubtotalPrice();
}

